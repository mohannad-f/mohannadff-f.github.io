<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØµØ§ÙŠØ§ Ø§Ù„Ù†Ø¨ÙŠ - BASIRA IMAN</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© -->
    <div class="floating-dots" id="floatingDots"></div>

    <!-- ØªØ°ÙƒÙŠØ± Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ -->
    <div class="prayer-reminder">
        <div class="prayer-ar">ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ Ù…Ø­Ù…Ø¯ ğŸ’š</div>
        <div class="prayer-en">Peace and blessings be upon our Prophet Muhammad</div>
    </div>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="container">
        <!-- Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© -->
        <header class="page-header">
            <a href="index.html" class="back-btn" id="backBtn">
                <i class="fas fa-arrow-right"></i>
                <span id="backText">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </a>
            <div class="page-title">
                <h1 class="title-ar" id="pageTitle">ÙˆØµØ§ÙŠØ§ Ø§Ù„Ù†Ø¨ÙŠ</h1>
                <p class="title-en" id="pageSubtitle">Prophet's Teachings</p>
            </div>
        </header>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« -->
        <section class="search-section" id="searchSection">
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«...">
                <button class="search-btn" onclick="performSearch()">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </section>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ« -->
        <div class="verses-list" id="hadithsList">
            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
        </div>

        <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø¯ÙŠØ« -->
        <main class="verse-content" id="hadithContent" style="display: none;">
            <!-- Ù†Øµ Ø§Ù„Ø­Ø¯ÙŠØ« -->
            <section class="verse-section">
                <div class="verse-header">
                    <h2>Ù†Øµ Ø§Ù„Ø­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙŠÙ</h2>
                    <div class="verse-actions">
                        <button onclick="toggleFavorite()" class="action-btn favorite-btn" id="favoriteBtn">
                            <i class="fas fa-heart"></i>
                            <span id="favoriteBtnText">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©</span>
                        </button>
                    </div>
                </div>
                <div class="verse-text-container">
                    <p class="verse-text" id="hadithText"></p>
                </div>
            </section>

            <!-- Ø§Ù„ØªÙØ³ÙŠØ± -->
            <section class="interpretation-section">
                <div class="section-header">
                    <h2>Ø§Ù„ØªÙØ³ÙŠØ± ÙˆØ§Ù„Ø´Ø±Ø­</h2>
                    <div class="section-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                </div>
                <div class="interpretation-content" id="tafsirContent">
                </div>
            </section>

            <!-- Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© -->
            <section class="english-section">
                <div class="section-header">
                    <h2>English Translation & Commentary</h2>
                    <div class="section-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                </div>
                <div class="english-content" id="englishContent">
                </div>
            </section>
        </main>
    </div>

    <script>
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
        function createFloatingDots() {
            const container = document.getElementById('floatingDots');
            const dotCount = 30;
            
            for (let i = 0; i < dotCount; i++) {
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.style.left = Math.random() * 100 + '%';
                const duration = 10 + Math.random() * 10;
                dot.style.animationDuration = duration + 's';
                dot.style.animationDelay = Math.random() * 5 + 's';
                const size = 3 + Math.random() * 3;
                dot.style.width = size + 'px';
                dot.style.height = size + 'px';
                container.appendChild(dot);
            }
        }
        
        window.addEventListener('load', createFloatingDots);

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let hadithsData = null;
        let currentHadithId = null;

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù
        fetch('hadith_data.json')
            .then(response => response.json())
            .then(data => {
                hadithsData = data.hadiths;
                showHadithsList();
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                const hash = window.location.hash;
                if (hash.startsWith('#hadith_')) {
                    const hadithId = parseInt(hash.replace('#hadith_', ''));
                    showHadith(hadithId - 1);
                }
            })
            .catch(error => {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            });

        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«
        function showHadithsList() {
            const hadithsList = document.getElementById('hadithsList');
            const hadithContent = document.getElementById('hadithContent');
            const searchSection = document.getElementById('searchSection');
            
            hadithsList.style.display = 'grid';
            hadithContent.style.display = 'none';
            searchSection.style.display = 'block';
            
            document.getElementById('pageTitle').textContent = 'ÙˆØµØ§ÙŠØ§ Ø§Ù„Ù†Ø¨ÙŠ';
            document.getElementById('pageSubtitle').textContent = "Prophet's Teachings";
            document.getElementById('backBtn').href = 'index.html';
            document.getElementById('backText').textContent = 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
            
            hadithsList.innerHTML = hadithsData.map((hadith, index) => {
                return `
                    <a href="#" onclick="showHadith(${index}); return false;" class="verse-item">
                        <div class="verse-item-title">${escapeHtml(hadith.name)}</div>
                    </a>
                `;
            }).join('');
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¯ÙŠØ« Ø§Ù„ÙƒØ§Ù…Ù„
        function showHadith(hadithIndex) {
            currentHadithId = hadithIndex;
            const hadith = hadithsData[hadithIndex];
            
            const hadithsList = document.getElementById('hadithsList');
            const hadithContent = document.getElementById('hadithContent');
            const searchSection = document.getElementById('searchSection');
            
            hadithsList.style.display = 'none';
            hadithContent.style.display = 'block';
            searchSection.style.display = 'none';
            
            document.getElementById('pageTitle').textContent = hadith.name;
            document.getElementById('pageSubtitle').textContent = "Hadith";
            document.getElementById('backBtn').href = '#';
            document.getElementById('backBtn').onclick = function() { showHadithsList(); return false; };
            document.getElementById('backText').textContent = 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«';
            
            // Ù†Øµ Ø§Ù„Ø­Ø¯ÙŠØ«
            document.getElementById('hadithText').textContent = hadith.hadith_text;
            
            // Ø§Ù„ØªÙØ³ÙŠØ±
            const tafsirParagraphs = hadith.tafsir_ar.split('\n\n').filter(p => p.trim());
            document.getElementById('tafsirContent').innerHTML = tafsirParagraphs.map(p => 
                `<p>${escapeHtml(p.trim())}</p>`
            ).join('');
            
            // Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
            const englishParts = hadith.english.split('\n\n').filter(p => p.trim());
            document.getElementById('englishContent').innerHTML = englishParts.map(part => {
                part = part.trim();
                if (part.startsWith('Narrated') || part.includes('(Sahih') || part.includes('[')) {
                    return `<p class="english-verse">${escapeHtml(part)}</p>`;
                } else {
                    return `<p>${escapeHtml(part)}</p>`;
                }
            }).join('');
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø©
            updateFavoriteButton();
            
            window.scrollTo(0, 0);
        }

        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«
        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            
            if (!searchTerm) {
                showHadithsList();
                return;
            }
            
            const hadithsList = document.getElementById('hadithsList');
            const hadithContent = document.getElementById('hadithContent');
            
            hadithsList.style.display = 'grid';
            hadithContent.style.display = 'none';
            
            document.getElementById('pageTitle').textContent = 'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«';
            document.getElementById('pageSubtitle').textContent = 'Search Results';
            document.getElementById('backBtn').href = '#';
            document.getElementById('backBtn').onclick = function() { showHadithsList(); return false; };
            document.getElementById('backText').textContent = 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«';
            
            let results = [];
            
            hadithsData.forEach((hadith, index) => {
                if (hadith.name.toLowerCase().includes(searchTerm) ||
                    hadith.hadith_text.toLowerCase().includes(searchTerm) ||
                    hadith.tafsir_ar.toLowerCase().includes(searchTerm)) {
                    results.push({
                        index: index,
                        hadith: hadith
                    });
                }
            });
            
            if (results.length === 0) {
                hadithsList.innerHTML = '<div style="text-align: center; padding: 40px; color: #fff; font-size: 1.2rem;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬</div>';
            } else {
                hadithsList.innerHTML = results.map(result => {
                    return `
                        <a href="#" onclick="showHadith(${result.index}); return false;" class="verse-item">
                            <div class="verse-item-title">${escapeHtml(result.hadith.name)}</div>
                        </a>
                    `;
                }).join('');
            }
            
            window.scrollTo(0, 0);
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        performSearch();
                    }
                });
            }
        });

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©
        function toggleFavorite() {
            if (currentHadithId === null) return;
            
            const hadith = hadithsData[currentHadithId];
            
            let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            
            const favoriteId = `hadith_${hadith.id}`;
            const existingIndex = favorites.findIndex(f => f.id === favoriteId);
            
            if (existingIndex !== -1) {
                // Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©
                favorites.splice(existingIndex, 1);
                showNotification('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø¯ÙŠØ« Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©');
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©
                favorites.push({
                    id: favoriteId,
                    type: 'hadith',
                    name: hadith.name,
                    text: hadith.hadith_text,
                    hadithId: hadith.id
                });
                showNotification('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯ÙŠØ« Ù„Ù„Ù…ÙØ¶Ù„Ø©');
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoriteButton();
        }

        function updateFavoriteButton() {
            if (currentHadithId === null) return;
            
            const hadith = hadithsData[currentHadithId];
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const favoriteId = `hadith_${hadith.id}`;
            const isFavorite = favorites.some(f => f.id === favoriteId);
            
            const btn = document.getElementById('favoriteBtn');
            const btnText = document.getElementById('favoriteBtnText');
            
            if (isFavorite) {
                btn.classList.add('active');
                btnText.textContent = 'Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©';
            } else {
                btn.classList.remove('active');
                btnText.textContent = 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©';
            }
        }

        // ØªÙ†Ø¸ÙŠÙ HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.classList.add('show');
            }, 100);

            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>

